# ğŸ¤– è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹ - å®Œæ•´é¡¹ç›®

## ğŸ“ é¡¹ç›®ç»“æ„
```
auto-purchase/
â”œâ”€â”€ auto_purchase.py          # ä¸»ç¨‹åº
â”œâ”€â”€ requirements.txt          # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ build.yml         # è‡ªåŠ¨æ‰“åŒ…é…ç½®
â””â”€â”€ README.md                 # ä½¿ç”¨è¯´æ˜
```

---

## ğŸ“„ æ–‡ä»¶1: auto_purchase.py

```python
"""
è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹ v2.0
åŠŸèƒ½ï¼šè‡ªåŠ¨ç™»å½•ã€ç›‘æ§åº“å­˜ã€ä¸€é”®ä¸‹å•
"""

import sys
import os
import time
from datetime import datetime

try:
    from selenium import webdriver
    from selenium.webdriver.common.by import By
    from selenium.webdriver.support.ui import WebDriverWait
    from selenium.webdriver.support import expected_conditions as EC
    from selenium.webdriver.chrome.service import Service
    from webdriver_manager.chrome import ChromeDriverManager
    SELENIUM_AVAILABLE = True
except ImportError:
    SELENIUM_AVAILABLE = False


class AutoPurchaseBot:
    def __init__(self):
        self.driver = None
        self.wait = None
        self.print_header()
    
    def print_header(self):
        """æ‰“å°æ ‡é¢˜"""
        print("\n" + "=" * 70)
        print(" " * 20 + "ğŸ¤– è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹ v2.0")
        print("=" * 70 + "\n")
    
    def check_dependencies(self):
        """æ£€æŸ¥ä¾èµ–"""
        print("ğŸ” æ£€æŸ¥è¿è¡Œç¯å¢ƒ...\n")
        
        if not SELENIUM_AVAILABLE:
            print("âŒ ç¼ºå°‘ Selenium åº“ï¼")
            print("\nè¯·è¿è¡Œï¼špip install -r requirements.txt\n")
            return False
        
        # æ£€æŸ¥ Chrome
        try:
            service = Service(ChromeDriverManager().install())
            print("âœ“ Chrome æµè§ˆå™¨æ£€æµ‹æˆåŠŸ")
            print("âœ“ ChromeDriver å‡†å¤‡å°±ç»ª\n")
            return True
        except Exception as e:
            print(f"âŒ Chrome æµè§ˆå™¨æœªå®‰è£…æˆ–ç‰ˆæœ¬ä¸å…¼å®¹")
            print(f"   é”™è¯¯ä¿¡æ¯: {str(e)}\n")
            print("è¯·å®‰è£… Chrome æµè§ˆå™¨ï¼šhttps://www.google.com/chrome/\n")
            return False
    
    def init_browser(self):
        """åˆå§‹åŒ–æµè§ˆå™¨"""
        try:
            print("ğŸ“¦ æ­£åœ¨å¯åŠ¨æµè§ˆå™¨...\n")
            
            options = webdriver.ChromeOptions()
            # options.add_argument('--headless')  # æ— å¤´æ¨¡å¼ï¼ˆåå°è¿è¡Œï¼‰
            options.add_argument('--disable-blink-features=AutomationControlled')
            options.add_argument('--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36')
            
            service = Service(ChromeDriverManager().install())
            self.driver = webdriver.Chrome(service=service, options=options)
            self.wait = WebDriverWait(self.driver, 10)
            
            print("âœ“ æµè§ˆå™¨å¯åŠ¨æˆåŠŸï¼\n")
            return True
            
        except Exception as e:
            print(f"âŒ æµè§ˆå™¨å¯åŠ¨å¤±è´¥: {str(e)}\n")
            return False
    
    def login(self, url, username, password):
        """ç™»å½•ç½‘ç«™"""
        try:
            print(f"ğŸ” æ­£åœ¨ç™»å½• {url}...\n")
            self.driver.get(url)
            
            # ç­‰å¾…ç”¨æˆ·æ‰‹åŠ¨ç™»å½•ï¼ˆæˆ–è‡ªåŠ¨å¡«å……ï¼‰
            print("â³ è¯·åœ¨æµè§ˆå™¨ä¸­å®Œæˆç™»å½•...")
            print("   ç™»å½•æˆåŠŸåï¼ŒæŒ‰ Enter ç»§ç»­...\n")
            input()
            
            print("âœ“ ç™»å½•ç¡®è®¤å®Œæˆ\n")
            return True
            
        except Exception as e:
            print(f"âŒ ç™»å½•å¤±è´¥: {str(e)}\n")
            return False
    
    def monitor_stock(self, product_url, check_interval=2):
        """ç›‘æ§åº“å­˜"""
        try:
            print(f"ğŸ‘€ å¼€å§‹ç›‘æ§å•†å“: {product_url}\n")
            self.driver.get(product_url)
            
            attempt = 0
            while True:
                attempt += 1
                current_time = datetime.now().strftime("%H:%M:%S")
                
                try:
                    # æŸ¥æ‰¾"ç«‹å³è´­ä¹°"æˆ–"åŠ å…¥è´­ç‰©è½¦"æŒ‰é’®
                    buy_button = self.driver.find_element(By.CSS_SELECTOR, 
                        "button[class*='buy'], button[class*='purchase'], button[class*='cart']")
                    
                    if buy_button.is_enabled():
                        print(f"âœ“ [{current_time}] ç¬¬ {attempt} æ¬¡æ£€æŸ¥ - å•†å“æœ‰è´§ï¼\n")
                        return True
                    else:
                        print(f"â³ [{current_time}] ç¬¬ {attempt} æ¬¡æ£€æŸ¥ - æš‚æ— åº“å­˜", end='\r')
                
                except:
                    print(f"â³ [{current_time}] ç¬¬ {attempt} æ¬¡æ£€æŸ¥ - æš‚æ— åº“å­˜", end='\r')
                
                time.sleep(check_interval)
                self.driver.refresh()
            
        except Exception as e:
            print(f"\nâŒ ç›‘æ§å‡ºé”™: {str(e)}\n")
            return False
    
    def purchase(self):
        """æ‰§è¡Œè´­ä¹°"""
        try:
            print("ğŸ›’ å¼€å§‹ä¸‹å•æµç¨‹...\n")
            
            # ç‚¹å‡»è´­ä¹°æŒ‰é’®
            buy_button = self.wait.until(
                EC.element_to_be_clickable((By.CSS_SELECTOR, 
                    "button[class*='buy'], button[class*='purchase']"))
            )
            buy_button.click()
            print("âœ“ å·²ç‚¹å‡»è´­ä¹°æŒ‰é’®")
            
            time.sleep(1)
            
            # ç‚¹å‡»ç»“ç®—æŒ‰é’®
            checkout_button = self.wait.until(
                EC.element_to_be_clickable((By.CSS_SELECTOR, 
                    "button[class*='checkout'], button[class*='settlement']"))
            )
            checkout_button.click()
            print("âœ“ å·²ç‚¹å‡»ç»“ç®—æŒ‰é’®")
            
            time.sleep(1)
            
            # ç‚¹å‡»æäº¤è®¢å•
            submit_button = self.wait.until(
                EC.element_to_be_clickable((By.CSS_SELECTOR, 
                    "button[class*='submit'], button[class*='confirm']"))
            )
            submit_button.click()
            print("âœ“ å·²æäº¤è®¢å•\n")
            
            print("ğŸ‰ è´­ä¹°æµç¨‹å®Œæˆï¼è¯·æ£€æŸ¥è®¢å•çŠ¶æ€\n")
            return True
            
        except Exception as e:
            print(f"âŒ è´­ä¹°å¤±è´¥: {str(e)}\n")
            return False
    
    def run(self):
        """ä¸»è¿è¡Œæµç¨‹"""
        try:
            # 1. æ£€æŸ¥ä¾èµ–
            if not self.check_dependencies():
                input("\næŒ‰ Enter é€€å‡º...")
                return
            
            # 2. åˆå§‹åŒ–æµè§ˆå™¨
            if not self.init_browser():
                input("\næŒ‰ Enter é€€å‡º...")
                return
            
            # 3. è·å–ç”¨æˆ·è¾“å…¥
            print("=" * 70)
            print("è¯·è¾“å…¥æŠ¢è´­ä¿¡æ¯")
            print("=" * 70 + "\n")
            
            login_url = input("ç™»å½•é¡µé¢ URL: ").strip()
            if not login_url:
                login_url = "https://www.taobao.com"
            
            product_url = input("å•†å“é¡µé¢ URL: ").strip()
            if not product_url:
                print("âŒ å•†å“ URL ä¸èƒ½ä¸ºç©ºï¼")
                return
            
            check_interval = input("æ£€æŸ¥é—´éš”(ç§’ï¼Œé»˜è®¤2): ").strip()
            check_interval = int(check_interval) if check_interval else 2
            
            print("\n")
            
            # 4. ç™»å½•
            if not self.login(login_url, "", ""):
                return
            
            # 5. ç›‘æ§åº“å­˜
            if not self.monitor_stock(product_url, check_interval):
                return
            
            # 6. æ‰§è¡Œè´­ä¹°
            self.purchase()
            
            # 7. ä¿æŒæµè§ˆå™¨æ‰“å¼€
            print("=" * 70)
            print("ä»»åŠ¡å®Œæˆï¼æµè§ˆå™¨å°†ä¿æŒæ‰“å¼€çŠ¶æ€")
            print("=" * 70 + "\n")
            input("æŒ‰ Enter å…³é—­æµè§ˆå™¨...")
            
        except KeyboardInterrupt:
            print("\n\nâš ï¸  ç”¨æˆ·ä¸­æ–­æ“ä½œ\n")
        
        except Exception as e:
            print(f"\nâŒ ç¨‹åºå‡ºé”™: {str(e)}\n")
        
        finally:
            if self.driver:
                self.driver.quit()
                print("âœ“ æµè§ˆå™¨å·²å…³é—­\n")


def main():
    """ä¸»å‡½æ•°"""
    bot = AutoPurchaseBot()
    bot.run()


if __name__ == "__main__":
    main()
```

---

## ğŸ“„ æ–‡ä»¶2: requirements.txt

```
selenium>=4.15.0
webdriver-manager>=4.0.1
```

---

## ğŸ“„ æ–‡ä»¶3: .github/workflows/build.yml

```yaml
name: Build EXE

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install pyinstaller
    
    - name: Build EXE
      run: |
        pyinstaller --onefile --noconsole --name "è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹" auto_purchase.py
    
    - name: Upload artifact
      uses: actions/upload-artifact@v3
      with:
        name: auto-purchase-exe
        path: dist/è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹.exe
```

---

## ğŸ“„ æ–‡ä»¶4: README.md

```markdown
# ğŸ¤– è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹

## âš ï¸ å…è´£å£°æ˜
æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå®é™…æŠ¢è´­ï¼Œä½¿ç”¨æœ¬å·¥å…·äº§ç”Ÿçš„ä»»ä½•åæœç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ã€‚

## ğŸ“¥ ä¸‹è½½ EXE

1. è¿›å…¥ [Actions](../../actions) é¡µé¢
2. ç‚¹å‡»æœ€æ–°çš„ workflow run
3. ä¸‹è½½ `auto-purchase-exe` æ–‡ä»¶
4. è§£å‹å¾—åˆ° `è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹.exe`

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å‰ç½®è¦æ±‚
- âœ… å®‰è£… Chrome æµè§ˆå™¨
- âœ… Windows 10/11 ç³»ç»Ÿ

### è¿è¡Œæ­¥éª¤
1. åŒå‡» `è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹.exe`
2. è¾“å…¥ç™»å½•é¡µé¢ URLï¼ˆå¦‚ï¼šhttps://www.taobao.comï¼‰
3. è¾“å…¥å•†å“é¡µé¢ URL
4. è®¾ç½®æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
5. åœ¨å¼¹å‡ºçš„æµè§ˆå™¨ä¸­æ‰‹åŠ¨ç™»å½•
6. ç­‰å¾…ç¨‹åºè‡ªåŠ¨ç›‘æ§å’Œè´­ä¹°

## ğŸ› ï¸ é«˜çº§é…ç½®

### ä¿®æ”¹ CSS é€‰æ‹©å™¨
ä¸åŒç½‘ç«™çš„æŒ‰é’®é€‰æ‹©å™¨ä¸åŒï¼Œéœ€è¦ä¿®æ”¹ä»£ç ä¸­çš„ï¼š
- è´­ä¹°æŒ‰é’®ï¼š`button[class*='buy']`
- ç»“ç®—æŒ‰é’®ï¼š`button[class*='checkout']`
- æäº¤æŒ‰é’®ï¼š`button[class*='submit']`

### æœ¬åœ°å¼€å‘
```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œç¨‹åº
python auto_purchase.py

# æ‰“åŒ…æˆ EXE
pip install pyinstaller
pyinstaller --onefile --noconsole auto_purchase.py
```

## ğŸ“ å¸¸è§é—®é¢˜

**Q: æç¤ºæ‰¾ä¸åˆ° Chromeï¼Ÿ**  
A: è¯·å®‰è£… Chrome æµè§ˆå™¨ï¼šhttps://www.google.com/chrome/

**Q: æ— æ³•ç‚¹å‡»è´­ä¹°æŒ‰é’®ï¼Ÿ**  
A: éœ€è¦æ ¹æ®ç›®æ ‡ç½‘ç«™ä¿®æ”¹ CSS é€‰æ‹©å™¨

**Q: è´¦å·è¢«å°ç¦ï¼Ÿ**  
A: è‡ªåŠ¨åŒ–æ“ä½œå¯èƒ½è¿åç½‘ç«™æ¡æ¬¾ï¼Œè¯·è°¨æ…ä½¿ç”¨

## ğŸ“œ è®¸å¯è¯
MIT License
```

---

## ğŸ¯ ä½¿ç”¨æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»º GitHub ä»“åº“

1. è®¿é—® https://github.com/new
2. ä»“åº“åï¼š`auto-purchase`
3. é€‰æ‹© Publicï¼ˆå…¬å¼€ï¼‰
4. ç‚¹å‡» "Create repository"

### ç¬¬äºŒæ­¥ï¼šä¸Šä¼ æ–‡ä»¶

åœ¨ä»“åº“é¡µé¢ç‚¹å‡» "Add file" â†’ "Create new file"ï¼Œä¾æ¬¡åˆ›å»ºï¼š

1. **auto_purchase.py** - å¤åˆ¶ä¸Šé¢çš„å®Œæ•´ä»£ç 
2. **requirements.txt** - å¤åˆ¶ä¾èµ–åˆ—è¡¨
3. **.github/workflows/build.yml** - å¤åˆ¶æ‰“åŒ…é…ç½®
4. **README.md** - å¤åˆ¶ä½¿ç”¨è¯´æ˜

### ç¬¬ä¸‰æ­¥ï¼šè‡ªåŠ¨æ‰“åŒ…

1. æ–‡ä»¶ä¸Šä¼ å®Œæˆåï¼ŒGitHub Actions ä¼šè‡ªåŠ¨å¼€å§‹æ‰“åŒ…
2. è¿›å…¥ä»“åº“çš„ **Actions** æ ‡ç­¾é¡µ
3. ç­‰å¾…ç»¿è‰²çš„ âœ“ æ ‡è®°ï¼ˆçº¦ 3-5 åˆ†é’Ÿï¼‰
4. ç‚¹å‡»æœ€æ–°çš„ workflow run
5. ä¸‹è½½ **auto-purchase-exe** æ–‡ä»¶
6. è§£å‹å¾—åˆ° `è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹.exe`

### ç¬¬å››æ­¥ï¼šä½¿ç”¨ EXE

1. ç¡®ä¿ç”µè„‘å·²å®‰è£… Chrome æµè§ˆå™¨
2. åŒå‡»è¿è¡Œ `è‡ªåŠ¨æŠ¢è´­åŠ©æ‰‹.exe`
3. æŒ‰æç¤ºè¾“å…¥ä¿¡æ¯å³å¯

---

## âš ï¸ é‡è¦æé†’

1. **æ³•å¾‹é£é™©** - è‡ªåŠ¨æŠ¢è´­å¯èƒ½è¿åç½‘ç«™æœåŠ¡æ¡æ¬¾
2. **è´¦å·å®‰å…¨** - å¯èƒ½å¯¼è‡´è´¦å·è¢«å°ç¦
3. **ä»…ä¾›å­¦ä¹ ** - è¯·å‹¿ç”¨äºå®é™…å•†ä¸šç”¨é€”
4. **ä¿®æ”¹é€‰æ‹©å™¨** - éœ€è¦æ ¹æ®å®é™…ç½‘ç«™è°ƒæ•´ä»£ç 

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
- æ£€æŸ¥æ˜¯å¦å®‰è£…äº† Chrome æµè§ˆå™¨
- æŸ¥çœ‹ GitHub Actions çš„é”™è¯¯æ—¥å¿—
- æ ¹æ®ç›®æ ‡ç½‘ç«™ä¿®æ”¹ CSS é€‰æ‹©å™¨